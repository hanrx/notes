

## [内容提要](docs/内容提要.md "内容提要")
* 提要：介绍如何将EagleEye项目一步一步地从单体架构重构成为微服务架构，进而将这个项目拆分成众多微服务，让它们运行在各自的Docker容器中，实现持续集成/持续部署，并最终自动部署到云环境（Amazon）中。


## [关于本书](docs/关于本书.md "关于本书")
* 适合的读者。
* 组织结构。
* 关于代码。

## [源码](docs/源码.md "源码")


## [附录A 在桌面运行云服务](docs/附录A%20在桌面运行云服务.md "附录A 在桌面运行云服务")
* 本附录主要内容
    * 列出运行本书中的代码所需的软件
    * 从GitHub上下载每章的源代码
    * 使用Maven编译和打包源代码
    * 构建和提供每章使用的Docker镜像
    * 使用Docker Compose启动由构建编译的Docker镜像
    * 构建Docker镜像：
        * Spotify Maven：服务都被打包为Docker镜像。
        * 使用Alpine Linux提供实例，常用来构建Docker镜像。
        * 将安装名为nc的命令行实用程序。nc命令用于ping服务器并查看特定的端口是否在网络上可用。该命令将在run.sh命令脚本中使用，以确保在启动服务之前，所有依赖的服务（如数据库和Spring Cloud Config服务）都已启动。
        * 为许可证服务的可执行JAR文件创建一个目录，然后将jar文件从本地文件系统复制到在Docker镜像上创建的目录中。
        * 通过ADD命令安装run.sh脚本。
        * 一旦将run.sh命令复制到许可证服务的Docker镜像，Docker命令CMD./run.sh用于告知Docker在实际镜像启动时执行run.sh启动脚本。
    * Docker Compose启动服务：
        * Docker Compose是一个服务编排工具，它允许开发人员将服务定义为一个组，然后作为一个单元一起启动。
        * Docker Compose还拥有为每个服务定义环境变量的功能。



## [第1章 欢迎迈入云世界，Spring](docs/第1章%20欢迎迈入云世界，Spring.md "第1章 欢迎迈入云世界，Spring")

* 什么是微服务：
    * 单体架构的问题在：在该应用程序上进行开发的各个团队的沟通与合作成本高。每当各个团队需要修改代码时，整个应用程序都需要重新构建、重新测试和重新部署。
    * 概述：微服务是一个小的、松耦合的分布式服务。
    * 信奉的重要概念：分解和分离应用程序的功能，使它们完全彼此独立。
    * 微服务框架具有以下的特征：
        * 确定义了职责范围的细粒度组件。
        * 完全独立部署。一个微服务可以跨多个应用程序复用。
        * 通信基于一些基本的原则，并采用HTTP和JSON（JavaScript Object Natation）这样的轻量级通信协议。
        * 底层技术无关。
        * 使组织拥有明确责任领域的小型开发团队容易。

* 什么是Spring，为什么它与微服务有关：
    * 依赖注入框架（如Spring），允许用户通过约定（以及注解）将应用程序对象之间的关系外部化，而不是在对象内部彼此硬编码实例化代码，以便更轻松地管理大型Java项目。
    * Spring Boot和Spring Cloud：为解决高度分布式的模式，服务能够被构建成可以轻松部署到云端的小型分布式服务。
    * Spring Boot：提供了一个基于Java的、面向REST的微服务框架。
    * Spring Cloud：在一个公共框架之下封装了多个流行的云管理微服务框架，并且让这些技术的使用和部署像为代码添加注解一样简便。

* 在本书中读者会学到什么：
    * 微服务是什么以及构建基于微服务的应用程序的设计考虑因素。
    * 什么时候不应该构建基于微服务的应用程序。
    * 如何使用Spring Boot框架来构建微服务。
    * 支持微服务应用程序的核心运维模式，特别是基于云的应用程序。
    * 如何使用Spring Cloud来实现这些运维模式。
    * 如何利用所学到的知识，构建一个部署管道，将服务部署到内部管理的私有云或公有云厂商所提供的环境中。

* 使用Spring Boot来构建微服务：

* 为什么要改变构建应用的方式：
    *及影响开发人员考虑构建应用程序的方式有：
        * 复杂性上升。
        * 客户期望更快速的交付。
        * 性能和可伸缩性。
        * 客户期望他们的应用程序可用。
    * 微服务可以构建具有下面这些特性的系统：
        * 灵活性——可以将解耦的服务进行组合和重新安排，以快速交付新的功能。一个正在使用的代码单元越小，更改代码越不复杂，测试部署代码所需的时间越短。
        * 有弹性——解耦的服务意味着应用程序不再是单个“泥浆球”，在这种架构中其中一部分应用程序的降级会导致整个应用程序失败。故障可以限制在应用程序的一小部分之中，并在整个应用程序遇到中断之前被控制。这也使应用程序在出现不可恢复的错误的情况下能够优雅地降级。
        * 可伸缩性——解耦的服务可以轻松地跨多个服务器进行水平分布，从而可以适当地对功能/服务进行伸缩。单体应用程序中的所有逻辑是交织在一起的，即使只有一小部分应用程序是瓶颈，整个应用程序也需要扩展。小型服务的扩展是局部的，成本效益更高。
    结语：小型的、简单的、和解耦的服务=可伸缩性、有弹性的和灵活的应用程序。

* 云到底是什么：云计算有3种基本模式。
    * 基础设施即服务（Infrastructure as a Service，IaaS）；
    * 平台即服务（Platform as a Service,Paas）；
    * 软件即服务（Software as a Service,SaaS）。
    * 函数即服务”（Functions as a Service,FaaS）。
    * “容器即服务”（Container as a Service,Caas）。

* 为什么是云和微服务：
    * 以弹性的概念为中心：云服务供应商允许开发人员在几分钟内快速启动新的虚拟机和容器。如果服务容量需求下降，开发人员可以关闭虚拟服务器，而不会产生任何额外的费用。使用云供应商部署微服务可以显著地提高应用程序的水平可伸缩性（添加更多的服务器和服务实例）。

* 微服务不只是编写代码:
    * 编写健壮的服务需要考虑几个主题：
        * 大小适当。
        * 位置透明。
        * 有弹性。
        * 可重复。
        * 可伸缩。
    * 采用基于模式的方法来回答这些问题：
        * 核心微服务开发模式；
            * 服务粒度。
            * 通信协议。
            * 接口设计。
            * 服务的配置管理。
            * 服务之间的事件处理。
        * 微服务路由模式；
            * 服务发现。
            * 服务路由。
        * 微服务客户端弹性模式；
            * 客户端负载均衡。
            * 断路器模式。
            * 后备模式。
            * 舱壁模式。
        * 微服务安全模式；
            * 验证。
            * 授权。
            * 凭据管理和传播。
        * 微服务日志记录和跟踪模式；
            * 日志关联。
            * 日志聚合。
            * 微服务跟踪。
        * 微服务构建和部署模式。
            * 构建和部署管道。
            * 基础设施即代码。
            * 不可变服务器。
            * 凤凰服务器（Phoenix server）。

* 使用Spring Cloud构建微服务：
    * Spring Boot：简化构建基于REST的微服务的核心任务，大大简化了微服务开发。
    * Spring Cloud Config：集中式服务来处理应用程序配置数据的管理，确保了无论启动多少个微服务实例，这些微服务实例始终具有相同的配置。拥有自己的属性管理存储库，也可以与以下开源项目集成。
    * Spring Cloud服务发现：开发人员可以从客户端消费的服务中抽象出部署服务器的物理位置（IP或服务器名称）。服务消费者通过逻辑名称而不是物理位置来调用服务器的业务逻辑。
    * Spring Cloud与Netflix Hystrix和Netflix Ribbon：
        * 使用Netfix Hystrix库，开发人员可以快速实现服务客户端弹性模式，如断路器模式和舱壁模式。
        * 虽然Netflix Ribbon项目简化了与诸如Eureka这样的服务发现代理的集成，但它也为服务消费者提供了客户端对服务调用的负载均衡。即使在服务发现代理暂时不可用时，客户端也可以继续进行服务调用。
    * Spring Cloud与Netflix Zuul：Zuul项目为微服务应用程序提供服务路由功能。Zuul是代理服务请求的服务网关，确保在调用目标服务之前，对微服务的所有调用都经过一个“前门”。通过集中的微服务调用，开发人员可以强制执行标准服务策略，如安全授权验证、内容过滤和路由规则。
    * Spring Cloud Stream：是一种可让开发人员轻松地将轻量级消息处理集成到微服务中的支持技术。
    * Spring Cloud Sleuth：允许将唯一的追踪标识符集成到应用程序所使用的HTTP调用和消息通道（RabbitMQ、Apache Kafka）之中。
    * Spring Cloud Security：是一个验证和授权框架，可以控制哪些人可以访问服务，以及他们可以用服务做什么。
    * 代码供应：实现一个“构建和部署”管道，开发人员需要使用Travis CI和Docker这两样工具，前者可以作为构建工具，而后者可以构建包含微服务的服务器镜像。
    
* 通过示例来介绍Spring Cloud：    
    


## [第2章 使用Spring Boot构建微服务](docs/第2章%20使用Spring%20Boot构建微服务.md "第2章 使用Spring Boot构建微服务")

* 传统的瀑布方法所面临的挑战在于： 紧耦合的、有漏洞的、单体的。

* 架构师的故事>设计微服务架构：作用是提供待解决问题的工作模型/提供脚手架。
    * 分解业务问题：
        * 将业务问题分解成代表离散活动领域的块。这些块封装了与业务域特定部分相关联的业务规则和数据逻辑。
        * 划分一组微服务的服务边界。
        * 解决办法：图描述业务用户对话时出现的一些名词和动词。图描述客户对话的简化数据模型
    * 建立服务粒度：可以采用以下思想来确定正确的解决方案：
        * 开始的时候可以让微服务设计的范围更广泛一些，然后将其重构到更小的服务。
        * 重点关注服务如何相互交互。
        * 随着对问题域的理解不断增长，服务的职责将随着时间的推移而改变。
    * 定义服务接口：目的》使服务接口易于理解和使用。以下指导方针思考服务接口设计：
        * 拥抱REST的理念。
        * 使用URI来传达意图。
        * 请求和响应使用JSON。
        * 使用HTTP状态码来传达结果。

* 何时不应该使用微服务：》其中的考量因素：
    * 构建分布式系统的复杂性；需投入>自动化和运维工作（监控、伸缩）
    * 虚拟服务器/容器散乱；>大量服务器或容器必须单独搭建和维护。
    * 应用程序的类型；>构建小型的、部门级的应用程序或具有较小用户群的应用程序不合时宜。
    * 数据事务和一致性。>应用程序需要跨多个数据源进行复杂的数据聚合或转换，那么微服务的分布式性质会让这项工作变得很困难

* 开发人员的故事：用Spring Boot和Java构建微服务：
    * 从骨架项目开始
    * 









