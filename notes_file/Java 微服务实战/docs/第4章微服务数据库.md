
# [README](../README.md "回到 README")
# [目录](本书的组织结构.md "回到 目录")


# 4.1 单数据源

在微服务中，通常一个服务只会使用一个数据库，所以我们首先以最简单的单数据源为例来介绍微服务中怎样操作数据库。

## 4.1.1 搭建项目框架

在IDEA中创建一个Maven项目，项目名称为dbandcache，项目的代码结构如图4-1所示。
![](images/4.1.1.1.png)

搭建好项目框架之后，进行数据库和数据表的创建。笔者使用的是MySQL，所以需要先在机器上安装MySQL。安装过程此处不再赘述，笔者使用的MySQL版本是5.7。为了方便，笔者还推荐使用一款MySQL的可视化客户端：Navicat，通过Navicat可以方便地进行数据库操作。


## 4.1.2 建库和建表
首先，创建数据库，库名为microservicedb1，之后执行如下的SQL语句建表t_user，并插入一条测试数据。
![](images/4.1.2.1.png)

建好表之后，就可以开始项目的开发了。


## 4.1.3 使用MyBatis-Generator生成数据访问层

这里**使用MyBatis-Generator来生成数据访问层的模板代码**。关于MyBatis-Generator,我们会在本章的“再学一招：MyBatis-Generator基本用法”部分 进行详细介绍。
    
首先，下载myBatis-generator-core-x.x.x.jar和mysql-connector-java-x.x.x.jar，并且创建MyBatis-Generator的配置文件generatorConfig-user.xml。最后将这些文件组成如图4-2所示的目录结构。
![](images/4.1.3.1.png)
之后，填写generatorConfig-user.xml的内容如下：
![](images/4.1.3.2.png)

在该文件中指定了**数据库的连接四要素（driver、connectionurl、username、password），生成的model类、mapper接口的位置以及映射文件的存储目录，最后指定了哪一张表（tableName）对应哪一个model（domainObjectName）**。这里值得注意是，model类和mapper类的位置一定要和如图4-1所示的项目代码结构相对应（即包名要写对），否则在代码生成之后，还需要进行修改。

之后，从终端进入MyBatis_Generator目录，执行如下语句：
![](images/4.1.3.3.png)

之后，在src目录下我们会看到User类、UserMapper接口及UserMapper.xml文件。将这些文件复制到相应的目录下即可。如果在执行语句时出现错误，**则需要先创建src文件夹**。


## 4.1.4 Spring Boot集成MyBatis



































































# [README](../README.md "回到 README")
# [目录](本书的组织结构.md "回到 目录")



