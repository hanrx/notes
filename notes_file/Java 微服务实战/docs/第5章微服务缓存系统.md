
# [README](../README.md "回到 README")
# [目录](本书的组织结构.md "回到 目录")

# 5.1 常用的缓存技术

## 5.1.1 本地缓存与分布式缓存

缓存一般分为**本地缓存和分布式缓存两种**。**本地缓存指的是将数据存储在本机内存中，操作缓存数据的速度很快，但是缺点也很明显：第一，缓存数据的数量与大小受限于本机内存；第二，如果有多台应用服务器，可能所有应用服务器都要维护一份缓存，这样就占用了很多的内存**。**分布式缓存正好解决了这两个问题。首先，数据存储在了另外的机器上，理论上由于可以不断添加缓存机器，所以缓存的数据的数量是无限的；其次，缓存集中设置在远程的缓存服务器上，应用服务器不需要耗费空间来维护缓存**。但是，分布式缓存也是有缺点的，比如**由于是远程操作，所以操作缓存数据的速度相较于本地缓存慢很多**。

当前**用的最多的本地缓存是GoogleGuavaCache**，我们会在本章的“再学一招：使用GuavaCache实现本地缓存”部分对其进行演示。**用得比较多的分布式缓存是Memcached和Redis**，下面介绍二者的应用。


## 5.1.2 Memcached与Redis

在Redis出现之前，Memcached一直是分布式缓存的标配，其**使用的经典的一致性hash算法是缓存软件算法的标准**；**基于slab的内存模型可以有效防止内部碎片的产生**，当然前提是设置好启动参数，否则会浪费很多内存；相较于Redis2.x 版本的客户端分片技术，Memcached的客户端分片编码会比较简单。那么，为什么越来越多的公司开始使用Redis而不再使用Memcached呢？首先，相较于**Memcache的单数据结构而言，Redis支持5种数据结构：string、hash、list、set、sorted set；Redis还提供了两种方式（RDB和AOF）**来支持数据持久化，从这一点来讲，Redis可以被看作内存数据库；**Redis还支持事件调度、发布订阅等，有时还可以充当一下队列**，例如在经典的ELK架构中，官方就推荐使用Redis构建缓冲队列。下面，介绍Redis的两种版本的使用方式：Redis2.x的客户端分片和Redis3.x的集群。


# 5.2 Redis 2.x客户端分片

## 5.2.1 安装Redis

在这一部分，笔者使用了两台操作系统是centos7的服务器，ip分别是10.211.55.10和10.211.55.11。Redis使用的版本是2.6.14。
* 第一步，在开发机下载redis-2.6.14.tar.gz，下载地址为：https://code.google.com/archive/p/redis/dowloads?page=1。
* 第二步，将在开发机下载好的redis-2.6.14.tar.gz分别复制到10.211.55.10和10.211.55.11。
![](images/5.2.1.1.png)
* 第三步，解压安装。
![](images/5.2.1.2.png)
* 第四步，启动服务。
![](images/5.2.1.3.png)

笔者直接使用Redis默认的配置文件来启动服务，并且设置为后台启动，将相关日志写入nohup.out文件中。
* 第五步，使用rdm（redis-desktop-manager）软件连接Redis。

 rdm是一款图形化的用于管理Redis的客户端。在其上可以方便地查询、删除Redis中的数据，连接信息如图5-1所示。


![](images/5.2.1.4.png)


## 5.2.2 Spring Boot集成ShardJedis

















































# [README](../README.md "回到 README")
# [目录](本书的组织结构.md "回到 目录")